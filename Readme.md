# Saber PKE and KEM
# Saber PKE and KEM

Saber is a lattice-based cryptosystem in NIST's post quantum-cryptogrpahy competition. It bases its security on the difficulty of the Learning With Rounding (LWR) Problem. It uses Modular Learning With Rounding (Mod-LWR) to save on memory space.


My java Implementation of the Saber cryptosystem involves 4 java class: `PKE.java`, `KEM.java`, `PolyMult.java`, and `Driver.java`.

</br>

## `PKE.java`
The public key encryption methods are in this class. Its most important functions include the key generation method `PKE.KeyGen`; the encryption method `PKE.Enc`; and the decryption method `PKE.Dec`. 

The class also includes other methods like `RandomBytes`, `Shake128` and other methods to convert to and from `BigInteger[]` and `byte[]`. These conversion methods as `BS2POL`, `BS2POLVEC`, `POL2BS` and `POLVEC2BS`.

### `PKE.KeyGen` 
* Takes no input
* Returns Public Key **b** and seedA used to generate matrix A (2240 bytes).

### `PKE.Enc`
* Takes a message m as a 256-degree polynomial of coeffcients in (0,1), a seed of 32 random bytes and the Public Key generated using `PKE.KeyGen`. 
* Returns the Cipher Text (1088 bytes).

### `PKE.Dec`
* Takes Cipher Text generated using `PKE.Enc` and Secret Key generated using `PKE.KeyGen`.
* Returns decryped message m (32 bytes)

</br>

## `KEM.java`
The key encapsulation mechanism methods are in this class. Its most important methods are: The key generation method `KEM.KeyGen`; the encapsulation method `KEM.Encaps`; and the decapsulation method `KEM.Decaps`.

### `KEM.KeyGen` 
* Takes no inputs.
* Outputs PublicKey and SecretKey (3296 bytes).

### `KEM.Encaps`
* Takes PublicKey generaeted by `KEM.KeyGen` .
* Returns SessionKey and CipherText (1120 bytes).

### `KEM.Decaps`
* Takes CipherText generated by `KEM.Encaps` and SecretKey generated by `KEM.KeyGen`.
* Outputs SessionKey (32 bytes).

</br>

## `PolyMult.java`
This class implements the Toom-Cook-4 polynomial mulitplication. This is the efficient mulitplication required for Saber implementation. Main componenets are: the driver method `PolyMult.PolyMul`, the splitting method `split`; evaluation method, `evaluation`; interpolation method, `interpolation`; and the reduction method `reduce`. 

### `PolyMult.PolyMul`
* Takes two 256-degree polynomials
* Returns a 256-degree polynomial product of the two input polynomials.


</br>

## `Driver.java`
This is the class that calls the PKE and KEM methods from their respective classes and writes the output of the encryption/decrption and encapsulation/decapsulation process to their respective `.txt` files.

</br>

## Bouncy Castle
Bouncy castle API is used to implement the `shake-128` hashes in `PKE`. 

To use the API, the [jar file](https://www.bouncycastle.org/latest_releases.html) needs to added to the class path.
